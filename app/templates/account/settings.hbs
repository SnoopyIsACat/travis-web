<section class='user-settings'>
  <section>
    <h3>API authentication</h3>

    <p>To learn more about using our API, please head to <a href='https://developer.travis-ci.com'>developer.travis-ci.com</a>.</p>

    {{account-token account=model}}
  </section>

  {{#if features.betaFeatures}}
    <section>
      <h3>Features</h3>
      <ul class="features-list">
        {{#each (sort-by "name" featureFlags) as |feature|}}
          {{beta-feature feature=feature}}
        {{else}}
          Oops! It looks like we don't have any experimental features for you
          to try yet.
        {{/each}}
      </ul>
    </section>
  {{/if}}

  {{#if scrollToEmail}}
    {{scroll-here}}
  {{/if}}
  <section class="email-settings" data-test-email-settings>
    <h3>Email notifications</h3>
    <div class="build-emails">
      <div class="row">
        <div class="name" data-test-email-settings-title>
          Build emails
        </div>
        <div class="description" data-test-email-settings-description>
          The status of your builds straight to your inbox
        </div>
        <div class="controls">
          {{travis-switch
            active=buildEmails
            disabled=toggleBuildEmails.isRunning
            onToggle=(perform toggleBuildEmails)
            data-test-email-settings-toggle=true
          }}
        </div>
      </div>
    </div>
    {{#if showResubscribeList}}
      <div class="unsubscribed-emails" data-test-email-settings-resubscribe-list>
        {{#paper-block title="Email notifications you've unsubscribed from" elevation=2 padding=false}}
          {{#each unsubscribedRepos as |repo|}}
            <div class="row" data-test-email-settings-resubscribe-item>
              <div class="name">
                {{#link-to 'repo' repo}}{{repo.formattedSlug}}{{/link-to}}
              </div>
              <div class="description"></div>
              <div class="controls">
                <button
                  class="button--white button--compact unsubscribe-button"
                  onclick={{perform repo.subscribe}}
                  data-test-email-settings-resubscribe-button
                >
                  {{#if repo.subscribe.isRunning}}
                    {{loading-indicator inline=true}}
                  {{else if repo.subscribe.last.error}}
                    Error! Try again.
                  {{else}}
                    {{svg-jar 'icon-email' class="icon" width="15px"}} Re-subscribe
                  {{/if}}
                </button>
              </div>
            </div>
          {{/each}}
        {{/paper-block}}
      </div>
    {{else if fetchRepositories.isRunning}}
      {{loading-indicator}}
    {{/if}}
  </section>
  <section class="active-visiblity-settings" data-test-active-visiblity-settings>
    <h3>Active Visibility Settings</h3>
    <div class="insights-settings">
      <div class="name" data-test-insights-settings-title>
        Insights
      </div>
      <p class="description" data-test-insights-settings-description>
        Get better information and make more informed decisions about your development workflow by
        understanding how you build code. Check out the Travis CI Insights Tab to see an overview.
        Insights about your open-source contributions are visible to the world, and you can optionally
        show aggregate information about your private contributions as well.
      </p>

      {{!-- Probably will want to move this out into a component or 2 --}}
      <ul class='travis-radio-list'>
        <li class='travis-radio-list__item'>
          <label for="user_insight_private">Do not share insights about your private builds</label>
          <input
            type="radio"
            name="user_insight_vis"
            class="travis-radio-input"
            id="user_insight_private"
            value="private"
            checked={{eq privateInsightsVisibility 'private'}}
            onchange={{action (perform setPrivateInsights 'private')}}
          />
          <label for="user_insight_private" class="travis-radio-label"></label>
        </li>
        <li class='travis-radio-list__item'>
          <label for="user_insight_public">Publicly share insights about your private builds</label>
          <input
            type="radio"
            name="user_insight_vis"
            class="travis-radio-input"
            id="user_insight_public"
            value="public"
            checked={{eq privateInsightsVisibility 'public'}}
            onchange={{action (perform setPrivateInsights 'public')}}
          />
          <label for="user_insight_public" class="travis-radio-label"></label>
        </li>
      </ul>
    </div>
  </section>
</section>
